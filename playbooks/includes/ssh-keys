---
# Maintains a set of SSH keys

- name: add authorized keys
  authorized_key: user={{ user }}
                  key="{{ lookup('file', item) }}"
  with_fileglob:
    - /etc/ansible/data/keys/{{ key_dir }}/{{ type | default(active) }}/*

- name: revoke old authorized keys
  authorized_key: user={{ user }}
                  key="{{ lookup('file', item) }}"
                  state=absent
  with_fileglob:
    - /etc/ansible/data/keys/{{ key_dir }}/revoked/*
